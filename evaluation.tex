\chapter{Evaluation}
\label{evaluation}
%What systems do we chose to show our evaluation on and why?
%Why are they important
%How are they different from each other?
%Why does my system selection show that our techniques are generalizable. 
Table \ref{tab:table1} presents the architectures of the three \ac{DNN}s used in \ac{APS}, \ac{HCAS}, and \ac{ACAS-Xu}, in increasing order of complexity. 
These applications are all mission critical, and can produce catastrophic outcomes in the presence of a successful attack.
They also come from two rather different domains: medical devices and autonomous vehicles, providing evidence of the generality of \tool. 

%We test our approach to incrementally larger DNNs. Larger DNNs imply networks with more layers and neurons per layer. %As mentioned previously, we have tested our approach for feed-forward neural networks that use ReLU for adding non-linearity. 


\begin{table}[h!]
	\begin{center}
		\caption{System descriptions}
		\label{tab:table1}
		\begin{tabular}{l|S|r|l}
			\textbf{} & \textbf{APS} & \textbf{HCAS} & \textbf{ACAS-Xu} \\
			%$\alpha$ & $\beta$ & $\gamma$ & $\gamma$ \\
			\hline
			\textbf{Size of the networks} &  &  &  \\
			Number of inputs &  74&   5&  5\\
			Number of hidden layers &  2&  5&  6\\
			Neurons/Layer &  8&  25 & 50 \\
			Number of outputs & 1&  3& 5\\
			\hline
			\hline
			
			%\textbf{Attacks synthesis (Avg. time in secs.)} &  &  &  \\
			%FDI attacks by perturbing 1 input &  0.01&  1000 &2700 \\
			%    FDI attacks by perturbing 2 inputs &  < 1&  2200&3600 \\
			%    FDI attacks by perturbing all inputs &  < 1&  2500& 5400 \\
			%    FDI attacks by perturbing 4 inputs  & &  & \\
			%    \hline
			%    \hline
		\end{tabular}
	\end{center}
\end{table}



\iffalse
We chose safety-critical applications for evaluating our approach. 
Our first application was inspired by the open-source system called openAPS.
Dutta et al. \cite{10.1007/978-3-319-99429-1_11} proposed a DNN for APS that takes in 74 inputs as explained in Section ~\ref{aps}.
The second and third systems are modeling a collision avoidance (CA) system; an automatic system designed for unmanned aerial vehicles.  
Manfredi et al. proposed ACAS Xu standards \cite{7778055}. 
These standards were implemented in \ac{ACAS-Xu} \ac{DNN}.
There are 45 DNNs that together make up the collision avoidance system \cite{Julian_2019}.  
Julian et al. \cite{Julian_2019} proposed a DNN compression for ACAS by representing large data tables in the form of DNNs. 
The \ac{ACAS-Xu} dataset is currently proprietary, so we did not have access to it. But for our tool, the trained model is enough to synthesize \ac{FDIA}. \ac{HCAS} is an open-source model created for collision avoidance. The reason we test our approach on \ac{ACAS-Xu} and \ac{HCAS} is that the architecture of these systems are different as shown in Table \ref{tab:table1}. 
The cost functions that we designed are the similar for the two cases.  
\fi 

Our overall methodology is described in Figure \ref{fig:methodology-2}. 
We pass the trained \ac{DNN} models through \tool, which then identifies the critical inputs, and perturbations for conducting \ac{RFDIA} (if they exist). 
Our tool currently supports TensorFlow \ac{DNN} formats  \cite{TensorFlow}. 
We wrote a Python script to synthesize \ac{MILP} models from \ac{DNN}s, and used it as our Gurobi interface. 

As explained in \ref{relusyn} the tool converts the \ac{DNN} to \ac{MILP} format and provides the critical inputs and the perturbations. 
We ran our experiments in server with a 2.40 GHz (10 MB L3 cache) Intel Xeon E5-2407 v2 processor
with 8 cores across 2 NUMA nodes and hyperthreading disabled. The server uses Ubuntu 16.04.6 LTS with 32 GB RAM that
is uniformly distributed (16 GB each) across both NUMA nodes.

%Gurobi's default mode that spawns multiple threads for solving a model; 


 

\begin{figure}
	\centering
	\includegraphics[width=0.7\linewidth]{"Images/Methodology2"}
	\caption[Methodology]{Our work supports DNNs modeled in tensorflow and pytorch. These files when passed through ReLUSyn produce the critical inputs and perturbations that can be used to conduct ripple false data injection attacks or determine that no such attack is possible.}
	\label{fig:methodology-2}
\end{figure}



\section{Case study: APS}
%The APS model designed by Kushner et al. \cite{Dutta_Others__2018__Robust}\smi{add space here}is a data-driven model. The goal of the model is to predict future blood glucose values for the patients.

As mentioned before in Section ~\ref{aps}, \ac{APS} takes 74 inputs ($37$ pairs of insulin and glucose values) gathered every $5$ minutes. 
It then predicts the next insulin value to be injected into the patient, which is $5$ minutes from the last calculated output by the network. 
%
%Attacks in the APS system.
Using \tool, we can successfully synthesize attacks in less than a minute, which is cost effective for an attacker.
%which works out well for an attacker since now the attacker can distort the inputs in one shot to cause damage in short time. 
%The experiments that we conduct






\begin{table}[h!]
	%\centering
	\caption{APS Results: The Attack column consists of the attack models where our goal is to minimize the inputs, Output ranges are the output bounds we have set where we want to find the deltas, no. of combinations is the combinations of attacks depending on the attack model (APS has 74 inputs) which is followed the total number of successful and unsuccessful attacks, peak time to conduct an attack in each set of experiment, memory used. }
	\label{APS}
	\begin{tabular}{|L{2cm}|L{2.7cm}|L{1cm}|L{1cm}|L{1cm}|L{1cm}|L{1cm}|L{4cm}|L{1cm}|}
		Attack & Output ranges (O) & No. of combinations  & Successful Attack(s) & Unsuccessful Attack(s) & Peak time (s)& Memory used/MB \\
		\hline
		
		\multicolumn{4}{c}{Attack 1: (-5 $<=$ Input $<$= 5)}\\
		\hline
		%\textbf{HCAS}&  &   & \\
		1 input changed at a time; delta minimization is primary objective& (204 $<$ O $<$ 210) \newline
		(210 $<$ O $<$ 215) \newline
		(215 $<$ O $<$ 220) \newline
		(220 $<$ O $<$ 221) \newline
		(200 $<$ O $<$ 203) \newline
		(197 $<$ O $<$ 200) \newline
		(194 $<$ O $<$ 197)& 74 \newline
		74 \newline
		74 \newline
		74 \newline
		74 \newline
		74 \newline
		74&   60 \newline
		2 \newline
		0 \newline
		0 \newline
		34 \newline
		16 \newline
		8& 14 \newline
		72 \newline
		74 \newline
		74 \newline
		40 \newline
		58 \newline
		66& 0.009 \newline
		0.001 \newline
		0.001 \newline
		0.001 \newline
		0.018 \newline
		0.008 \newline
		0.001& 21.8 \newline
		18.2 \newline
		18.1 \newline
		18.2 \newline
		22.8 \newline
		22.2 \newline
		18.5  \\
		
		
		\hline
		\multicolumn{4}{c}{Attack 2: (-5 $<=$ Input $<$= 5)}\\
		\hline
		%\textbf{HCAS}&  &   & \\
		2 inputs changed at a time; delta minimization is primary objective&(204 $<$ O $<$ 210) \newline
		(210 $<$ O $<$ 215) \newline
		(215 $<$ O $<$ 220) \newline
		(220 $<$ O $<$ 221) \newline
		(200 $<$ O $<$ 203) \newline
		(197 $<$ O $<$ 200) \newline
		(194 $<$ O $<$ 197)&  2701 \newline
		2701 \newline
		2701 \newline
		2701  \newline
		2701  \newline
		2701 \newline
		2701& 2669 \newline
		220 \newline
		29 \newline
		2 \newline
		2142 \newline
		1374 \newline
		739&   32 \newline
		2481 \newline
		2672 \newline
		2699 \newline
		559 \newline
		1327 \newline
		1962& 0.029\newline
		0.0139 \newline
		0.006 \newline
		0.003 \newline
		0.0632 \newline
		0.0412  \newline
		0.0413 & 21.8
		18.2
		18.1
		18.2
		22.8
		22.2
		18.5\\
		
		\hline
		\multicolumn{4}{c}{Attack 3: (-5 $<=$ Input $<$= 5)}\\
		\hline
		%\textbf{HCAS}&  &   & \\
		74 (All) inputs changed at a time; delta minimization is primary objective&  (204 $<$ O $<$ 210) \newline
		(210 $<$ O $<$ 215) \newline
		(215 $<$ O $<$ 220) \newline
		(220 $<$ O $<$ 221) \newline
		(200 $<$ O $<$ 203) \newline
		(197 $<$ O $<$ 200) \newline
		(194 $<$ O $<$ 197)& 1 \newline
		1 \newline
		1 \newline
		1 \newline
		1 \newline
		1 \newline
		1&   1 \newline
		1 \newline
		1 \newline
		1 \newline
		1 \newline
		1 \newline
		1& 0 \newline
		0 \newline
		0 \newline
		0 \newline
		0 \newline
		0 \newline
		0& 0.037
		0.060
		0.049
		0.045
		0.110
		0.073
		0.062&23.1
		19.1
		20.3
		20.3
		22.5
		22.0 \newline
		23.0\\
		\hline
		
		
		
		
		
		
		
		
		
	\end{tabular}
\end{table}

\begin{table}[h!]
	\begin{center}
		\caption{Critical Inputs - APS - 1 Input perturbed at a time. These are the safe ranges that we obtain from the specification document for a patient. We perturb inputs   }
		\label{criticalinputs}
		\begin{tabular}{|l|r|}
			\textbf{Output range}  & \textbf{Critical Inputs}  \\
			%$\alpha$ & $\beta$ & $\gamma$ & $\gamma$ \\
			\hline
			(204 $<= Output <=$ 210)&  (1-5, 7, 9-13, 34-43,45,70-74) \\
			
			
			(210 $<= Output <=$ 215) &   (41, 43)\\
			(215 $<= Output <=$ 220) &  X \\
			(220 $<= Output <=$ 221) &  X \\
			%(200 <= Output <= 203) &  74& , 50, 51, 53, 54, 55, 56, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 72, 73) \\
			(200 $<= Output <=$ 203) &  (23, 31, 35, 36, 38-41, 42, 45-51, 53-56, 59-70, 72, 73) \\
			(197 $<= Output <=$200) & (40, 45, 48-51, 56, 61, 63-67, 70, 72, 73)\\
			\hline
			\hline
			
			
		\end{tabular}
	\end{center}
\end{table}

\subsection{Experimental methodology}

Our experimental methodology is as follows:
we consider a set of accurate inputs and construct perturbation scenarios.
A perturbation scenario consists of
\begin{enumerate}
	\item  Number of inputs to perturb
	\item  Range by which we can perturb each input. 
\end{enumerate}
	
For each perturbation scenario, we evaluate our attack efficacy for a range of different outcomes. 
 In \ac{APS}, if a normal output value is $x$; we consider $n$ different output ranges as shown in Table ~\ref{APS} and \ref{criticalinputs}, each of which administer too much insulin, differing only in how much additional insulin is administered.	
 We then exhaustively test each unique attack in the perturbation scenario till we obtain the smallest one.
 For example as shown in Table ~\ref{APS}, if the perturbation scenario is "Attack only a single input, change its value by $<= +/- 5$ and the objective is input perturbation minimization" then, given 74 inputs, we run 74 tests for each target output range till we find the feasible input. 
 We chose $5$ in our evaluation despite the units of insulin and glucose units being different, because we have constraints in the model that add the maximum and minimum values of insulin and glucose, which if $<$ $5$ and $>$ $-5$  respectively override $5$. 
 In \ac{APS}, we set the insulin and glucose ranges based on their units, and if $5$ is greater or less than their maximum and minimum values respectively, then $5$ is overridden by their ranges. 
 We do so because there are too many combinations to test to find all possible perturbations if we check for smaller ranges, or try to find every attack value that can possibly exist.   
 We iterate over the 74 different inputs, perturbing each by a random amount in the range ($x$ - $5$) $<=$ ($x$ + $5$) so we find the one with the smallest perturbation. 
 Finally, the inputs that on small perturbations lead to output deviations  becomes our critical inputs set as shown in Table ~\ref{criticalinputs} for one specific case. 
 
 
 Table ~\ref{APS} shows the results for three perturbation scenarios: changing a single input, changing two inputs, and changing all inputs, within a range of $+-$ $5$, % for each scenario.   
 
%The goal is to minimize the input perturbations such that the output is perturbed by amounts so it remains between the user-specified lower and the upper bounds.
%Injecting more than the required amounts even if within the bounds is potentially fatal for users of the systems. 
%Randomly changing inputs can trigger alarms in the system because it will raise the levels above the bounds enforced by specifications. We want to perturb the inputs in a stealthy way. The stealthiness is induced by finding the exact perturbations and to find those exact perturbations we need \tool. Brute force would require to search through the entire search space. We model the attack by including a $delta$ function in the inputs. 
\subsection{Result Analysis}
Results are shown in Table ~\ref{summary} and Table ~\ref{APS}. 
We find that for different ranges of outputs, the critical inputs vary as shown in Table ~\ref{criticalinputs}.         
\begin{enumerate}
	\item We show the critical inputs for the case where one input perturbation is enough to produce a desirable output change. 
	This makes attacking easy from an attacker's perspective because to conduct a successful \ac{RFDIA}, perturbing a single input is enough to cause damage instead of changing multiple inputs. 
	\item We kept the $delta$ range  to be between $+-5$ which is a very small perturbation for the insulin values which ideally lie between $100-200$; hence we can observe that small perturbations are enough to conduct successful \ac{RFDIA}.  
	\item  We show that it takes less than a second to identify the critical inputs and find the minimum perturbations for all the attacks.
	\item As we can observe in Table ~\ref{APS}, as the number of perturbed inputs increases, the possible combinations of critical inputs also increases. 
	
\end{enumerate}


 





%, For example, we find that when we perturb one input for an output range of 194-197, changing any one of these (40, 50, 61, 63, 66, 67, 72, 73) inputs by certain amounts will result in a successful  FDI \attack. Due to space reasons, we provide a summary of all combinations of attacks in Table II for APS. 
%Along with the critical inputs, we also obtain the perturbations that will lead to an output deviation. 
%Further we try 

%We observe that it is feasible to find one input perturbation that can cause output perturbations without getting detected. We find every attack for APS within seconds. We test out our approach by perturbing specific inputs at a time instead of randomly finding attacks. 

%We generate attacks by keeping all inputs constant but one to observe the above phenomenon. We keep all inputs constant but two in the next set of the experiment to understand if it is easier to find such attacks as compared to finding only one input perturbation and in the process, we are successfully able to locate the critical inputs.  






%Table template
\iffalse
\begin{table}[h!]
	%\centering
	\caption{Results Summary}
	%\label{summary}
	\begin{tabular}{l|S|r|l|r|l|r|l}
		Attack & Attack  & No. of  & Successful & Unsuccessful  & Peak  & Memory \\
		&  No. &  combinations &  Attack(s) & Attack(s& time& used \\
		\hline
		
		\multicolumn{4}{c}{Random}\\
		\hline
		%\textbf{HCAS}&  &   & \\
		&  & &   & & &\\
		&  & &   & & &\\
		
		\hline
		\multicolumn{4}{c}{Targeted}\\ 
		\hline
		
		
	\end{tabular}
\end{table}
\fi

%\section{FDI attack 2}
%In our next set of attacks we maximize the output deviation and minimize the input deviations. We do so to cause the maximum damage possible to a patient by perturbing inputs within bounds yet we want it to perturb by maximum amounts within those bounds. As shown in Table 2  in the lower half we conduct a similar analysis by keeping everything constant but perturbing on 1, 2 and then finally all inputs together. We conduct these experiments to show that our technique is capable of identifying one critical input and also a set of critical inputs that can cause output deviations. 



\section{Case Study: ACAS-Xu and HCAS}




\begin{table}[h!]
	%\centering
	\caption{HCAS Results: The different attacks are explained in the Attack column which depends on the order of the outputs and the ranges of the deltas, the number of inputs to be perturbed are selected by the attacker for  conducting each attack, the total number of combinations are calculated based on the total number of inputs  and the inputs selected to be perturbed, the peak time is the maximum time it took to test for an attack from the combinations, X indicates that the experiments timed out.}
	\label{hcas}

		\begin{tabular}{|L{3cm}|L{2cm}|L{1cm}|L{1cm}|L{1cm}|L{1cm}|L{1cm}|L{2cm}|L{1cm}|}
		Attack & Inputs perturbed & No. of combinations  & Successful Attack(s) & Unsuccessful Attack(s) & Peak time (s)& Memory used/ MB &Critical inputs\\
		\hline
		
		\multicolumn{4}{c}{Random}\\
		\hline
		%\textbf{HCAS}&  &   & \\
		Attack 1 - One output is set to be minimum (others can be ordered arbitrarily); deltas are restricted to be 5 at the max and are minimized& 1A - 1 input
		1B - 2 inputs
		1C - 3 inputs & 12 \newline
		12 \newline
		4&   5 \newline
		11 \newline
		4& 7 \newline
		1 \newline
		0& 5.7 \newline
		94.3 \newline
		80.9& 70.2 \newline
		108 \newline
		103.5 & {0: [(0), (2)], 2: [(1)], 4: [(0), (1)]} \newline All but {1: [(1,2)]} 
		\\
		
		
		\hline
		\multicolumn{4}{c}{Targeted 1}\\ 
		\hline
			Attack 1 - Complete ordering on outputs; deltas do not have user-specified restriction and are not minimized &
			1A - 1 input
			1B - 2 inputs
			1C - 3 inputs& 3 \newline
			3\newline
			1 & 0\newline
			0\newline
			0&  3\newline
			3\newline
			1 &7.9 \newline
			174.4 \newline
			1130.6& 73.1 \newline
			114.9 \newline
			152.7 & NA\\
			
	 	\hline
	 \multicolumn{4}{c}{Targeted 2}\\ 
	 \hline
	 Attack 2 - Complete ordering on outputs; deltas do not have user-specified restriction and are not minimized&  2A - 1 input
	 2B - 2 inputs
	 2C - 3 inputs& 3 \newline
	 3 \newline
	 1&   0 \newline
	 0 \newline
	 0& 3 \newline
	 3 \newline
	 1& 6.7 \newline
	 214.6 \newline
	 2039.2 &71.5 \newline
	 123.9 \newline
	 290.1 & NA\\    
	 
	 
	 
	 	 	\hline
	 \multicolumn{4}{c}{Targeted 3}\\ 
	 \hline
	 Attack 3 - Partial ordering on outputs; deltas do not have user-specified restriction and are not minimized&  3A - 1 input
	 3B - 2 inputs
	 3C - 3 inputs& 3 \newline
	 3 \newline
	 1&   2 \newline
	 3 \newline
	 1& 1 \newline
	 0 \newline
	 0& 3.0 \newline
	 4.2 \newline
	 2.7& 69.0 \newline
	 71.5 \newline
	 67.4 & [0], [2] \newline
	  ([0,1],[0,2], [1,2]) \newline
	 ([0,1,2])\\
	 \hline
	  	 
		
		
	\end{tabular}
\end{table}

\begin{table}[h!]
	%\centering
	\caption{HCAS Results continued}
	\label{hcas2}
	
	\begin{tabular}{|L{3cm}|L{2cm}|L{1cm}|L{1cm}|L{1cm}|L{1cm}|L{1cm}|L{2cm}|L{1cm}|}
	Attack & Inputs perturbed & No. of combinations  & Successful Attack(s) & Unsuccessful Attack(s) & Peak time& Memory used &Critical inputs\\
	\hline
		\multicolumn{4}{c}{Targeted 4}\\ 
		\hline
		Attack 4 - Partial ordering on outputs; deltas do not have user-specified restriction and are minimized& 4A - 1 input
		4B - 2 inputs
		4C - 3 inputs & 3 \newline
		3 \newline
		1&   2 \newline
		3 \newline
		1& 1 \newline
		0 \newline
		0& 1 \newline
		0 \newline
		0& 69.4 \newline
		83.1 \newline
		76 & ([0], [2]) \newline
		([0,1], [0,2], [1,2]) \newline
		([0,1,2]) \\
		\hline
		\multicolumn{4}{c}{Targeted 5}\\ 
		\hline
		Attack 5 - Partial ordering on outputs; deltas do not have user-specified restriction and are not minimized&  5A - 1 input
		5B - 2 inputs
		5C - 3 inputs& 3 \newline
		3 \newline
		1&   0 \newline
		0 \newline
		1& 3 \newline
		3 \newline
		0& 4.9 \newline
		229.6 \newline
		1.8& 69.7 \newline
		110.4 \newline
		58.9 & 
		X  \newline
		X \newline
		([0,1,2])\\
		
		\hline
		\multicolumn{4}{c}{Targeted 6}\\ 
		\hline
		Attack 6 - Partial ordering on outputs; deltas do not have user-specified restriction and are minimized &
		6A - 1 input
		6B - 2 inputs
		6C - 3 inputs&  3 \newline
		3 \newline
		1& 0 \newline
		0 \newline
		1&   
		3 \newline
		3 \newline
		0 &
		X \newline
		X \newline
		357.4&
		X \newline
		X \newline
		111.1& 
		X  \newline
		X \newline
		([0,1,2])\\
		
		\hline
		\multicolumn{4}{c}{Targeted 7}\\ 
		\hline
		Attack 7 - Partial ordering on outputs; deltas do not have user-specified restriction and are not minimized&  7A - 1 input
		7B - 2 inputs
		7C - 3 inputs& 3 \newline
		3 \newline
		1&   1 \newline
		3 \newline
		1& 2 \newline
		0 \newline
		0& 3.5 \newline
		24.8 \newline
		1.9& 67.9 \newline
		90.5 \newline
		62.0 & [1] \newline 
	([0,1], [0,2], [1,2]) \newline
		([0,1,2])\\
		
		\hline
	
		
		
		
	\end{tabular}
\end{table}

\begin{table}[h!]
	%\centering
	\caption{HCAS Results continued}
	\label{hcas3}
	
	\begin{tabular}{|L{3cm}|L{2cm}|L{1cm}|L{1cm}|L{1cm}|L{1cm}|L{1cm}|L{2cm}|L{1cm}|}
	Attack & Inputs perturbed & No. of combinations  & Successful Attack(s) & Unsuccessful Attack(s) & Peak time& Memory used &Critical inputs\\
	\hline
		\multicolumn{4}{c}{Targeted 8}\\ 
		\hline
		Attack 8 - Partial ordering on outputs; deltas do not have user-specified restriction and are minimized&  8A - 1 input
		8B - 2 inputs
		8C - 3 inputs& 3 \newline
		3 \newline
		1&  1 \newline
		3 \newline
		1 & 2 \newline
		0 \newline
		0& 3.5 \newline
		80.5 \newline
		67.9& 68.6 \newline
		104.4 \newline
		103.1 & [1] \newline
		([0,1], [0,2], [1,2])
		([0,1,2])\\
		
		\hline
		\multicolumn{4}{c}{Targeted 9}\\
		\hline
		%\textbf{HCAS}&  &   & \\
		Attack 9 - Partial ordering on outputs; deltas do not have user-specified restriction and are not minimized& 9A - 1 input
		9B - 2 inputs
		9C - 3 inputs & 3 \newline
		3 \newline
		1&  0 \newline
		1 \newline
		1 & 3 \newline
		2 \newline
		0& 6.3 \newline
		139.3 \newline
		314.1 & 67.3 \newline
		98.4 \newline
		126.6 & 
		X \newline
		([1,2]) \newline
		([0,1,2])\\
		
			\hline
		\multicolumn{4}{c}{Targeted 10}\\
		\hline
		Attack 10 - Partial ordering on outputs; deltas do not have user-specified restriction and are minimized &
		10A - 1 input \newline
		10B - 2 inputs \newline
		10C - 3 inputs&
		3 \newline
		3 \newline
		1&
		0 \newline
		1 \newline
		1&
		3 \newline
		2 \newline
		0&
		4.7 \newline
		85.0 \newline
		228.8&
		71.6 \newline
		92.7 \newline
		109.9 &
		X \newline
		([1,2]) \newline
		([0,1,2])\\
		\hline 
		
		
	\end{tabular}
\end{table}

\begin{table}[h!]
	%\centering
	\caption{ACAS-Xu Results: The different attacks are explained in the Attack column which depends on the order of the outputs and the ranges of the deltas, the number of inputs to be perturbed are selected by the attacker for  conducting each attack, the total number of combinations are calculated based on the total number of inputs  and the inputs selected to be perturbed, the peak time is the maximum time it took to test for an attack from the combinations, X indicates that the experiments timed out.}
	\label{acasxu}
		

	\begin{tabular}{|L{3cm}|L{2cm}|L{1cm}|L{1cm}|L{1cm}|L{1cm}|L{1cm}|l}
		Attack & Inputs perturbed & No. of combinations  & Successful Attack(s) & Unsuccessful Attack(s) & Peak time& Memory used\\
	
		\hline
		\multicolumn{4}{c}{Random}\\
		\hline
		%\textbf{HCAS}&  &   & \\
		One output is set to be minimum (others can be ordered arbitrarily); deltas are restricted to be 5 at the max and are minimized& 1A - 1 input
		1B - 2 inputs
		1C - 3 inputs
		1D - 4 inputs
		1E - 5 inputs & 
		20  \newline
		40  \newline
		40   \newline
		20   \newline 
		4&  2  \newline
		9 \newline
		12 \newline
		8 \newline
		2 &
		18 \newline
		31\newline
		28\newline
		12\newline
		2 & 465.8
		4141.1
		6644.9
		17637.9
		11528.4&
		160.7 \newline
		209.1 \newline
		269.1 \newline
		449.5 \newline
		348.2 \\
		
		
		
		
		
		\hline
		\multicolumn{4}{c}{Targeted}\\ 
		\hline
		Complete ordering on outputs; deltas are restricted to be 5 at the max and are minimized&  1A - 1 input
		1B - 2 inputs
		1C - 3 inputs
		1D - 4 inputs
		1E - 5 inputs& 5 \newline
		10 \newline
		10  \newline
		5 \newline
		1&  0 \newline
		0 \newline
		0 \newline
		0 \newline
		0 &5 \newline
		10 \newline
		10 \newline
		5 \newline
		1 & 739.4
		3678.1
		7296.6
		24041.9
		4434.7& 204.8
		202.6
		296
		562.1
		200.2\\
		
		
		\hline
		\multicolumn{4}{c}{Targeted}\\ 
		\hline
		
		Partial ordering on outputs; deltas are restricted to be 5 at the max and are minimized&  2A - 1 input
		2B - 2 inputs
		2C - 3 inputs
		2D - 4 inputs
		2E - 5 inputs& 5 \newline
		10  \newline
		10  \newline
		5  \newline
		1&  0  \newline
		0 \newline
		X \newline
		X \newline 
		0 &5 \newline
		10  \newline
		X \newline X \newline
		
		1 & 975.8
		3816.4
		X\newline
		
		X \newline
		4766.6& 223.2 \newline
		197.1 \newline
		X \newline
		X \newline
		
		218.6\\
		
		\hline
		\multicolumn{4}{c}{Targeted}\\ 
		\hline
		Attack 3 - Partial ordering on outputs; deltas are unrestricted	&  3A - 1 input
		3B - 2 inputs
		3C - 3 inputs
		3D - 4 inputs
		3E - 5 inputs&  5 \newline
		10 \newline
		10 \newline
		5 \newline
		1 &   0\newline
		1\newline
		X \newline
		X \newline
		1&5 \newline
		9 \newline
		X \newline
		X \newline
		0&
		1075.0
		62876.6
	X \newline
	X	\newline
		8311.2& 288.2
		1740.5
	X	\newline
	X	\newline
		1447.4 \\
		\hline
	\end{tabular}
\end{table}
%We test our approach on two other available systems that are collision avoidance (CA) as explained in the above section. 
The ACAS Xu and HCAS are different from each other in terms of their architectures and parameters as shown in Table ~\ref{tab:table1}. 
Apart from the difference between the weights, bias and the number of layers, the datasets used to produce the two are also quite different. 

%We conduct two random and targeted \attack \smi{this is singular but should perhaps be plural; good idea to skim the rest of the paper where \attack is used} in these systems, to understand how the systems\smi{this sentence is incomplete}
The geometry of \ac{ACAS-Xu} is shown in Figure ~\ref{fig:acasxugeometry}.
The ownship is the unmanned vehicle with the \ac{CA} system and the intruder's (another vehicle) goal is to crash with the ownship. 
The \ac{ACAS-Xu} is designed to model a large lookup table that maps sensor readings to the decisions based on the readings or advisories. 
This is represented as forty-five different \ac{DNN} models. 
Each network has the architecture as described Table ~\ref{tab:table1} with $5$ inputs, $6$ hidden layers and $5$ outputs.  

There are five sensor readings (inputs to the network): 
\begin{enumerate}[noitemsep,nolistsep]
	\item Distance from ownship to intruder ($\upvarrho$)
	\item Angle to the intruder relative to ownship heading direction ($\psi$)
	\item Header angle to intruder relative to ownship heading direction  ($\theta$)
	\item Speed of ownship ($v_{own}$)
	\item Speed of intruder($v_{int}$)
\end{enumerate}

The $5$ outputs are:
\begin{enumerate}[noitemsep,nolistsep]
		\item clear-of-conflict (COC): keep going in the same direction
	\item weak right: Turn ($1.5\degree /s$) to right
	\item strong right:  Turn  ($3 \degree /s$) to right
	\item weak left: Turn ($1.5\degree /s$) to left
	\item strong left: Turn ($3 \degree /s$) to left
\end{enumerate}

\ac{ACAS-Xu}'s goal is to avoid crashes of the ownship with the intruder; in case the two are getting too close, an action is taken that moves the two apart. 
The output in the \ac{DNN} corresponds to the score of outputs where the one with the minimal score is the action to be taken. 
This means that based on the sensor readings, if the output score for $strong$ $right$ is the least of all the other outputs then the unmanned vehicle should turn $3 \degree /s$ to its right to avoid a crash. 

\ac{HCAS} functions similar to \ac{ACAS-Xu} apart from the architectural differences as stated in Table 5.1. 

We conduct two types of \ac{RFDIA}: targeted and random.
In targeted attacks, the attacker specifically chooses a particular action to take, and in a random attack, the model should produce any output that differs from the correct one. 

\begin{figure}
	\centering
	\includegraphics[width=0.7\linewidth]{Images/ACASXugeometry}
	\caption[ACAS Xu]{ACAS Xu geometry}
	\label{fig:acasxugeometry}
\end{figure}

\subsection{Experiment Methodology}
We consider a set of accurate inputs and construct perturbation scenarios. A perturbation scenario consists of 
\begin{enumerate}
	\item The output order
	\item Inputs perturbed
\end{enumerate}

\subsubsection{Random Attack}
Unlike \ac{APS} that had a concrete value as an output, in \ac{ACAS-Xu} and \ac{HCAS}, the output action depends on the scores. 
In a random attack, if the normal output was $strong$ $right$ the attacker's goal
is to change the output to $COC$.
This would lead to a crash since according to the new output decision, there is no intruder in the vicinity, and the unmanned vehicle should keep following its original path. 
This can be done by adding a constraint that ensures that the score of $COC$ is the least among all other outputs. 
The orderings of other outputs is of no concern to the attacker so long $COC$ has the least score. 

For each perturbation scenario, we evaluate our attack efficacy for different orderings, which means that if the correct decision based on the scores is $1$, then we perturb the inputs such that the output changes to $2$.
For this to happen the score for $2$ has to be the least of all other outputs. 

$Attack$ $1$ in Table ~\ref{hcas} is an example of a random attack where we set one of the outputs to be the least of all the outputs. 
The ordering of rest of outputs does not matter because the decision is selected based on the output with the least score. 
We test it by checking for attacks by perturbing $1$, $2$ and $3$ inputs at a time. 
From a practical scenario, a random attack is useful for an attacker because
they just have to state one constraint in this case, $value(2)$ $<$ $(all$ $other$ $values)$.

\subsubsection{Targeted Attack}

 
In a targeted attack, if the original output was $strong$ $right$, the goal of the attacker is to change the output to $strong$ $left$. 
The difference from a random attack is that the attacker wants the order of all the other inputs also to be in a specific order. 
This is to avoid potentially getting detected, since if the score for $strong$ $left$ is the lowest and the next higher score is for $strong$ $right$, this can trigger conflicts that are likely to be detected. 
Hence, the attacker sets constraints with a specific order such that $strong$ $left$ is followed by $weak$ $left$. 

Multiple different orders are tested for in Table ~\ref{hcas}, ~\ref{hcas2}, ~\ref{hcas3} and ~\ref{acasxu} for \ac{HCAS} and \ac{ACAS-Xu}. 

We conducted two types of targeted attacks:
\begin{enumerate}
\item Total ordering: In total ordering, there is a specific order decided by the attacker.
\item Partial ordering: In partial ordering, the order is set only for the first two outputs.  
\end{enumerate}



\iffalse

Consider a set of five inputs for which the output is weak left. 
The output weak left indicates that the \ac{DNN} returns 4. 
The network is trained in a way such that the least value signifies the output that should be taken next. 
The attacker's goal is to change the output in a way such that the minimum value changes from weak left to weak right. 
To model this, we first add a delta value to the inputs as in our previous evaluation. 
To do so, we add constraints that force the output to 5 instead of 4; the constraints look of the form "$05 < $(All other outputs)".
\fi


 
The attacker can conduct various targeted attacks using the critical inputs as shown in Table ~\ref{hcas}, ~\ref{hcas2}, ~\ref{hcas3} and ~\ref{acasxu} for \ac{HCAS} and \ac{ACAS-Xu}. 



\iffalse
\subsection{FDI random attack} 
Constructing random \ac{RFDIA} attacks is slightly less effort for the attacker as compared to targeted attacks; this is because the constraints in a targeted setting are much tighter. 
Building on the previous example, if we have 5 inputs that give us the result as output 4, we need to perturb the inputs such that the output changes to any of the other possibilities such as output 1, output 2, output 3 and output 5.

In this case, we try out multiple different combinations that allow us to find the perturbations as shown in Table ~\ref{hcas}, ~\ref{hcas2}, ~\ref{hcas3} and ~\ref{acasxu} for \ac{HCAS} and \ac{ACAS-Xu}.
\fi

\subsection{Result Analysis}
Some interesting observations were:
\begin{enumerate}
	\item We found attacks where perturbing a single input was enough to change the output decision.  
	\item In a complete ordering targeted attack scenario, we were unable to find a single successful attack. We believe this was so because the constraints were too tight. 
	\item When we tried finding the smallest perturbation, several experiments timed out but finding a perturbation between $delta$ was successful. 
\end{enumerate}	


\section{Summary}
\begin{enumerate}
	\item Overall, we conducted ~19,000 attacks for \ac{APS} out of which ~7200 attacks were successful, and took less than 1 second per attack. 
	\item We conducted ~30 \ac{HCAS} random attacks out of which ~20 were successful, and the maximum amount taken by the attacks was 41 seconds.
	\item We conducted ~7 targeted attacks for \ac{HCAS} out of which 1 attack was successful.
	\item We conducted ~140 \ac{ACAS-Xu} random attacks out of which ~32 were successful, and the maximum amount taken by the attacks was 7228 seconds.
	\item We conducted ~16 targeted attacks for \ac{HCAS}, out of which 2 attacks was successful.
\end{enumerate}

 
These results are shown in Table ~\ref{summary}.

Thus we can see that synthesizing \ac{RFDIA} attacks can be easily accomplished by the attacker in a small amount of time using \tool. 
We have also tried out multiple different combinations of attacks keeping multiple attacker scenarios in mind, and show that for systems such as \ac{APS} perturbing a single input out of the 74 inputs is enough to cause damage in Table ~\ref{APS}.
Similarly for \ac{HCAS} and \ac{ACAS-Xu}, we observe  from Table ~\ref{hcas}, ~\ref{hcas2}, ~\ref{hcas3} and ~\ref{acasxu} that perturbing a single input in certain scenarios is enough to cause output deviation. 

 \begin{table}[h!]
 	%\centering
 	\caption{Results Summary}
 	\label{summary}
 	\begin{tabular}{l|S|r|l}
 		\textbf{Inputs-pert} & \textbf{Total} &  \textbf{Successful} & \textbf{Mean-Time/ } \\
 		urbed/Attack &  Attacks &  Attacks &  Attack(s) \\
 		\hline
 		\multicolumn{4}{c}{APS}\\
 		\hline
 		1 &  518& 120 &  0.0015\\
 		2 &  18907& 7175 &  0.002\\
 		74 &  7& 7 &  0.03\\
 		\hline
 		\multicolumn{4}{c}{HCAS - Random}\\
 		\hline
 		%\textbf{HCAS}&  &   & \\
 		1 &  12& 5 &  3.87\\
 		2 &  12& 11 &  32.89\\
 		3 &  4&  4&  41.14\\
 		\hline
 		\multicolumn{4}{c}{HCAS - Targeted (Partial Ordering)}\\
 		\hline
 		%\textbf{HCAS}&  &   & \\
 		1 &  3& 1&  2.14\\
 		2 &  3& 0 &  2.91\\
 		3 &  1&  0&  2.74\\
 		\hline
 		\multicolumn{4}{c}{ACAS Xu - Random}\\
 		\hline
 		%\textbf{HCAS}&  &   & \\
 		1 &  20& 2&  100.11\\
 		2 &  40& 9& 548.72\\
 		3 &  40& 12&  1452.176\\
 		4 &  20&  8&  5029.58\\
 		5 &  20&  2&  7228.966\\
 		\hline
 		\multicolumn{4}{c}{ACAS Xu- Targeted (Partial Ordering)}\\ 
 		\hline
 		%\textbf{HCAS}&  &   & \\
 		1 &  5& 0&  297.2\\
 		2 &  10& 1 &  23595.58\\
 		5 &  1&  1&  8311.21\\
 		\hline
 		\hline
 	\end{tabular}
 \end{table}
